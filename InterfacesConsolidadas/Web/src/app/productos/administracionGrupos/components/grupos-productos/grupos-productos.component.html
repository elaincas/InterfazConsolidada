<app-main-loader></app-main-loader>
<div class="main-content">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-12">

        <div class="card">
          <div class="card-header card-header-icon" data-background-color="red">
            <i class="material-icons">class</i>
          </div>
          <div class="card-content">
            <h4 class="card-title">Categorías de Productos</h4>
            <div class="form-group">
              <button type="button" class="btn btn-Azulsiman btn-round btn-fab btn-fab-mini" (click)="abrirCrearCategoria()">
                <i class="material-icons">add</i>
                <div class="ripple-container"></div>
              </button>
            </div>

            <dx-data-grid [showBorders]="true" [masterDetail]="{ enabled: true, template:'subcategoriasTemplate'}" [rowAlternationEnabled]="true"
              [dataSource]="categoriasProductos">
              <dxo-filter-row [visible]="true"> </dxo-filter-row>

              <dxo-header-filter [visible]="true"></dxo-header-filter>
              <dxo-search-panel [visible]="true" [width]="240" placeholder="Buscar..."></dxo-search-panel>

              <dxi-column caption="Descripción" dataField="descripcion"> </dxi-column>
              <dxi-column caption="Ruta" dataField="rutaWeb" [width]="200"> </dxi-column>
              <dxi-column caption="Productos" dataField="cantidadProductos" [width]="100"> </dxi-column>
              <dxi-column caption="Subcategorías" dataField="cantidadSubgrupos" [width]="120">
                <dxo-header-filter [visible]="false">
                </dxo-header-filter>
              </dxi-column>

              <dxi-column caption="Acciones" cellTemplate="accionTemplate" [width]="100"> </dxi-column>
              <dxo-paging [pageSize]="10" [pageIndex]="1">
              </dxo-paging>

              <div *dxTemplate="let d of 'accionTemplate'">
                <button rel="tooltip" (click)="eliminar(d.data)" type="button" class="btn btn-grid btn-danger ">
                  <i class="material-icons">close</i>
                </button>
                <button rel="tooltip" (click)="editar(d.data)" type="button" class="btn btn-grid btn-Azulsiman ">
                  <i class="material-icons">mode_edit</i>
                </button>
              </div>

              <div *dxTemplate="let subCategoria of 'subcategoriasTemplate'">
                <dx-data-grid [dataSource]="subCategoria.data.subGrupos" [masterDetail]="{ enabled: true, template: 'subcategoriasTercerNivelTemplate'}"
                  [showBorders]="true">
                  <dxi-column caption="Descripción" dataField="descripcion"> </dxi-column>
                  <dxi-column caption="Ruta" dataField="rutaWeb" [width]="200"> </dxi-column>
                  <dxi-column caption="Productos" dataField="cantidadProductos" [width]="100"> </dxi-column>
                  <dxi-column caption="Subcategorías" dataField="cantidadSubgrupos" [width]="120">
                    <dxo-header-filter [visible]="false">
                    </dxo-header-filter>
                  </dxi-column>
                  <dxo-paging [pageSize]="10" [pageIndex]="1">
                  </dxo-paging>

                  <div *dxTemplate="let subCategoriaTercerNivel of 'subcategoriasTercerNivelTemplate'">
                    <dx-data-grid [dataSource]="subCategoriaTercerNivel.data.subGrupos" [showBorders]="true">
                      <dxi-column caption="Descripción" dataField="descripcion"> </dxi-column>
                      <dxi-column caption="Ruta" dataField="rutaWeb" [width]="200"> </dxi-column>
                      <dxi-column caption="Productos" dataField="cantidadProductos" [width]="100"> </dxi-column>
                      <dxo-paging [pageSize]="10" [pageIndex]="1">
                      </dxo-paging>
                    </dx-data-grid>
                  </div>
                </dx-data-grid>
              </div>

            </dx-data-grid>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
